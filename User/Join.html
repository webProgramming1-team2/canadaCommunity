
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>캐모아 - 회원가입</title>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <link rel="stylesheet" href="../User/Join.css">
    <script>

        function fn_sendMember() {

        const form = document.form;
        const name = form.name.value;
        const id = form.id.value;
        const pwd = form.passwd.value;
        const r_pwd = form.r_passwd.value;
        const f_num = form.fst_num.value;
        const s_num = form.scd_num.value;
        const t_num = form.trd_num.value;
        const gender = form.gender.value;

        if (name.length === 0 || name === "") {
            alert("이름(닉네임) 입력은 필수입니다.");
            form.name.focus();
        } else if (id.length === 0 || id === "") {
            alert("아이디 입력은 필수입니다.");
            form.id.focus();
        } else if (pwd.length === 0 || pwd === "") {
            alert("비밀번호 입력은 필수입니다.");
            form.passwd.focus();
        } else if (r_pwd.length === 0 || r_pwd === "") {
            alert("비밀번호 입력은 필수입니다.");
            form.r_passwd.focus();
        } else if (r_pwd !== pwd) {
            alert("비밀번호가 일치하지 않습니다.");
            form.passwd.focus();
        } else if (f_num.length === 0 || f_num === "") {
            alert("연락처 입력은 필수입니다.");
            form.fst_num.focus();
        } else if (s_num.length === 0 || s_num === "") {
            alert("연락처 입력은 필수입니다.");
            form.scd_num.focus();
        } else if (t_num.length === 0 || t_num === "") {
            alert("연락처 입력은 필수입니다.");
            form.trd_num.focus();
        } else if (gender === "") {
            alert("성별 입력은 필수입니다.");
        }else {
            let userData = {};
            userData.name = form.name.value;
            userData.id = form.id.value;
            userData.passwd = form.id.value;
            userData.phone_num = form.fst_num.value + "-" + form.scd_num.value
            + "-" + form.trd_num.value;
            userData.gender = form.gender.value;
            

                $.getJSON("User.json", function(data) {
                    data.push(json);
                    alert(json);
                });
                
                data.push(userData);
                new saveJson(data).download();

            // form.method = "post";
            // form.action = "join_db.jsp";
            // form.submit();
            //submit으로 서버에 양식 제출
        }
    }
    class saveJson {
        // 클래스 생성자 초기화 실시
        constructor(data = []) {
            this.data = data;
        }

        // 파일 다운로드 수행 실시
        download(type_of = "application/json", filename ="User.json") { // 확장자명을 json 으로 지정
            let txt = [];
            txt.push(JSON.stringify(this.data, null, 2));
            let body = document.body; // body 변수 선언
            const a = document.createElement("a"); // a 태그 생성
            
            a.href = URL.createObjectURL(new Blob(txt, {
                type: type_of
            }));
            
            a.setAttribute("download", filename); // a 태그에 다운로드 속성 추가
            body.appendChild(a); // body에 a 태그 추가
            a.click(); // 클릭 이벤트를 발생시켜 다운로드
            body.removeChild(a); // body에서 제거
            
        }
    }
    
    $(document).ready(function () {
        $(document.getElementById("header")).load("../Main/Header.html");
        $(document.getElementById("footer")).load("../Main/Footer.html");

        $("#list").html(tblStr);
    });
    function btn_click() {

            if (str == "submit") {
            form.method = "get";
            //폼의 메소드 방식
            form.action = "join_fail.jsp";
            //데이터를 보낼 곳을 action으로 지정
            form.target = "param";
            // 프레임이름?

            }
        }
      

        function btn_click() {
   
                if (str == "submit") {
                form.method = "get";
                //폼의 메소드 방식
                form.action = "join_fail.jsp";
                //데이터를 보낼 곳을 action으로 지정
                form.target = "param";
                // 프레임이름?

                }
        }

        $(document).ready(function () {
            $(document.getElementById("header")).load("../Main/Header.html");
            $(document.getElementById("footer")).load("../Main/Footer.html");
        });

    </script>
</head>

<body>
<!--header 파일에서 작업-->
<div id="header"></div>
<div id="section">
    <div class="title">회원가입</div>
    <form name="form" id="form" >
        <table>
            <tr>
                <td class="line" colspan="2">기본정보</td>
            </tr>
            <tr>
                <th>이름</th>
                <td><input class="box" type="text" name="name"></td>
            </tr>
            <tr>
                <th>아이디</th>
                <td><input class="box" type="text" name="id" ></td>
            </tr>
            <tr>
                <th>비밀번호</th>
                <td><input class="box" type="password" name="passwd"></td>
            </tr>
            <tr>
                <th>비밀번호확인</th>
                <td><input class="box" type="password" name="r_passwd"></td>
            </tr>
            <tr>
                <th>연락처</th>
                <td><select name="fst_num">
                    <option value="">--선택--</option>
                    <option value="010">010</option>
                    <option value="011">011</option>
                    <option value="016">016</option>
                    <option value="02">02</option>
                    <option value="031">031</option>
                    <option value="070">070</option>
                </select> - <input class="box" type="text" name="scd_num" size=5 maxlength="4" > -
                    <input class="box" type="text" name="trd_num" size=5 maxlength="4" ></td>
            </tr>

            <tr>
                <td></td>
                <th>성별</th>
                <td><input type="radio" name="gender" name="gender" value="male"> 남자
                    <input type="radio" name="gender" name="gender" value="female"> 여자
                </td>
            </tr>
            <tr>
                <td colspan="3"><input class="s_btn" type="submit" value="회원가입" onclick="fn_sendMember()"></td>
            </tr>
        </table>
    </form>
</div>
<!--footer 파일에서 작업-->
<div id="footer"></div>
</body>
</html>